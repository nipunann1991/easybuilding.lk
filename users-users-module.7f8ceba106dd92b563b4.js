(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{q536:function(t,e,r){"use strict";r.r(e);var i=r("ofXK"),s=r("tyNb"),o=r("njyG"),n=r("K9Ia"),a=r("3Pt+"),c=r("GZih"),d=r("EVdn"),u=r("9Ahp"),l=r("fXoL"),f=r("qT8p"),p=r("CYa2"),m=r("lwXW"),b=r("bTqV");function g(t,e){if(1&t){var r=l.Fc();l.Ec(0,"div",2),l.Ec(1,"h3",3),l.ud(2,"Add Admin Users"),l.Dc(),l.Ec(3,"form",8),l.Lc("ngSubmit",(function(){return l.id(r),l.Pc().onAddAdminUser()})),l.Ec(4,"div",0),l.Ec(5,"div",9),l.Ec(6,"div",10),l.Ec(7,"label",11),l.ud(8,"User Email"),l.Dc(),l.zc(9,"input",12),l.Dc(),l.Ec(10,"div",10),l.Ec(11,"label",13),l.ud(12,"Role"),l.Dc(),l.zc(13,"ng-select2",14),l.Dc(),l.Ec(14,"div",10),l.Ec(15,"label",15),l.ud(16,"Password"),l.Dc(),l.zc(17,"input",16),l.Dc(),l.Dc(),l.Ec(18,"div",9),l.Ec(19,"button",17),l.ud(20,"Add Admin User"),l.Dc(),l.Ec(21,"button",18),l.Lc("click",(function(){return l.id(r),l.Pc().clearForm()})),l.ud(22,"Clear"),l.Dc(),l.Dc(),l.Dc(),l.Dc(),l.Dc()}if(2&t){var i=l.Pc();l.mc(3),l.Vc("formGroup",i.formGroup),l.mc(10),l.Vc("data",i.roleData)}}function h(t,e){if(1&t){var r=l.Fc();l.Ec(0,"div",2),l.Ec(1,"h3",3),l.ud(2,"Edit Admin Users"),l.Dc(),l.Ec(3,"form",8),l.Lc("ngSubmit",(function(){return l.id(r),l.Pc().onUpdateAdminUser()})),l.Ec(4,"div",0),l.Ec(5,"div",9),l.Ec(6,"div",10),l.Ec(7,"label",11),l.ud(8,"User Email"),l.Dc(),l.zc(9,"input",12),l.Dc(),l.Ec(10,"div",10),l.Ec(11,"label",13),l.ud(12,"Role"),l.Dc(),l.zc(13,"ng-select2",14),l.Dc(),l.Ec(14,"div",19),l.Ec(15,"label",15),l.ud(16,"Password"),l.Dc(),l.zc(17,"input",16),l.Dc(),l.Dc(),l.Ec(18,"div",9),l.Ec(19,"button",17),l.ud(20,"Edit Admin User"),l.Dc(),l.Ec(21,"button",20),l.ud(22,"Close"),l.Dc(),l.Dc(),l.Dc(),l.Dc(),l.Dc()}if(2&t){var i=l.Pc();l.mc(3),l.Vc("formGroup",i.formGroup),l.mc(10),l.Vc("data",i.roleData)}}var v=function(){function t(t,e,r,i,s){this.settings=t,this.router=e,this.route=r,this.toastr=i,this.authservice=s,this.dtOptions={},this.dtTrigger=new n.a,this.isEditableRoute=!1,this.param={}}return t.prototype.ngOnInit=function(){var t=this;this.getUserRole(),this.formGroup=new a.h({user_email:new a.f("",[a.s.required]),role_id:new a.f("",[a.s.required]),password:new a.f("",[a.s.required,a.s.minLength(8),a.s.maxLength(100)])}),this.route.paramMap.subscribe((function(e){t.param=e,void 0!==t.param.params.id&&(t.isEditableRoute=!0,t.getSingleAdminUser())})),this.dtOptions={pagingType:"full_numbers",pageLength:10,serverSide:!0,processing:!0,autoWidth:!1,ajax:this.settings.getAdminUsersDT(),columns:[{data:"user_id"},{data:"user_email"}],columnDefs:[{targets:2,data:function(t){return 1==t.role_id?'<span class="badge badge-success">Active</span>':2==t.role_id?'<span class="badge badge-success">'+t.role_name+"</span>":3==t.role_id?'<span class="badge badge-warning">'+t.role_name+"</span>":void 0}},{targets:3,data:function(t){return'<a class="edit-user-data" data-id="'+t.user_id+'" title="Edit"><i class="icon-pencil"></i></a> <a class="delete-user-data" data-id="'+t.user_id+'" title="Edit"><i class="icon-bin"></i></a>'}}],dom:"lfrtip",buttons:[{extend:"copyHtml5",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',titleAttr:"Export to Excel"},{extend:"csvHtml5",text:'<i class="fa fa-file-text-o"></i> CSV',titleAttr:"Export to CSV"},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',titleAttr:"Export to PDF"}]};var e=this;d("html").on("click","a.delete-user-data",(function(t){t.preventDefault(),e.openDeleteUserModal(d(this).attr("data-id"))}));var r=this;d("html").on("click","a.edit-user-data",(function(t){t.preventDefault(),r.editUser(d(this).attr("data-id"))}))},t.prototype.editUser=function(t){this.router.navigate(["admin/settings/users/"+t])},t.prototype.openDeleteUserModal=function(t){var e=this,r=bootbox.confirm({title:"Delete User",message:"Are you sure you need to delete this user?",buttons:{confirm:{label:"Yes",className:"btn-danger pull-left"},cancel:{label:"No",className:"pull-right "}},callback:function(r){r&&e.deleteUser(t)}});r.init((function(){d("html .modal-backdrop:not(:first)").remove()})),r.on("shown.bs.modal",(function(){d("html .bootbox.modal:not(:first)").remove()}))},t.prototype.deleteUser=function(t){var e=this;this.settings.deleteUser({user_id:t}).subscribe((function(t){200==t.status?(e.toastr.success("City has been deleted successfully","Success !"),d("#refresh-btn").trigger("click")):e.toastr.error("City deleting failed. Please try again","Error !")}))},t.prototype.ngAfterViewInit=function(){this.dtTrigger.next()},t.prototype.ngOnDestroy=function(){this.dtTrigger.unsubscribe()},t.prototype.rerender=function(){var t=this;this.dtElement.dtInstance.then((function(e){e.destroy(),t.dtTrigger.next()}))},t.prototype.getUserRole=function(){var t=this;this.settings.getUserRole().subscribe((function(e){var r=[];200==e.status?e.data.forEach((function(e,i){r.push({id:e.role_id,text:e.role_name}),t.roleData=r})):console.log(e)}))},t.prototype.clearForm=function(){this.formGroup.reset()},t.prototype.onAddAdminUser=function(){var t=this;this.formGroup.invalid||(this.formGroup.value.auth_token=this.authservice.generateRandomToken(),this.settings.addAdminUser(this.formGroup.value).subscribe((function(e){200==e.status?(t.toastr.success("New city has been added successfully","Success !"),t.formGroup.reset(),d("#refresh-btn").trigger("click")):t.toastr.error("New city adding failed. Please try again","Error !")})))},t.prototype.getSingleAdminUser=function(){var t=this;this.settings.getSingleAdminUser({user_id:this.param.params.id}).subscribe((function(e){if(200==e.status){console.log(e.data);var r=e.data[0];t.formGroup.setValue({role_id:r.role_id,user_email:r.user_email,password:r.password})}else console.log(e)}))},t.prototype.onUpdateAdminUser=function(){var t=this;this.formGroup.invalid||this.settings.editAdminUser({user_id:this.param.params.id,user_email:this.formGroup.value.user_email,role_id:this.formGroup.value.role_id}).subscribe((function(e){200==e.status?(t.toastr.success("User has been edited successfully","Success !"),t.formGroup.reset(),d("#refresh-btn").trigger("click"),t.returnBack()):t.toastr.error(401==e.status?"Invalid user token or session has been expired. Please re-loging and try again.":"User editing failed. Please try again","Error !")}))},t.prototype.returnBack=function(){this.router.navigate(["admin/settings/users"])},t.\u0275fac=function(e){return new(e||t)(l.yc(c.a),l.yc(s.c),l.yc(s.a),l.yc(f.b),l.yc(u.a))},t.\u0275cmp=l.sc({type:t,selectors:[["app-users"]],viewQuery:function(t,e){var r;1&t&&l.zd(o.a,!0),2&t&&l.ed(r=l.Mc())&&(e.dtElement=r.first)},decls:20,vars:4,consts:[[1,"row"],[1,"col-md-8"],[1,"white-box-panel"],[1,"title"],["id","refresh-btn","type","button",1,"btn","waves-effect","waves-light","blue","d-none",3,"click"],["datatable","",1,"row-border","hover",3,"dtOptions","dtTrigger"],[1,"col-md-4"],["class","white-box-panel",4,"ngIf"],["id","myform","novalidate","novalidate",1,"wrapped-block",3,"formGroup","ngSubmit"],[1,"col-md-12"],[1,"form-group"],["for","user_email"],["id","user_email","name","user_email","formControlName","user_email","type","text",1,"form-control"],["for","role_id"],["formControlName","role_id",1,"select-fw",3,"data"],["for","password"],["id","password","name","password","formControlName","password","type","password",1,"form-control"],["mat-button","","name","submit","type","submit",1,"btn","btn-primary"],["mat-button","","type","button",1,"btn","btn-default","clear-btn",3,"click"],[1,"form-group","d-none"],["mat-button","","type","button",1,"btn","btn-default","close-btn"]],template:function(t,e){1&t&&(l.Ec(0,"div",0),l.Ec(1,"div",1),l.Ec(2,"div",2),l.Ec(3,"h3",3),l.ud(4,"Admin Users List"),l.Dc(),l.Ec(5,"button",4),l.Lc("click",(function(){return e.rerender()})),l.ud(6," Rerender "),l.Dc(),l.Ec(7,"table",5),l.Ec(8,"thead"),l.Ec(9,"tr"),l.Ec(10,"th"),l.ud(11,"User Id"),l.Dc(),l.Ec(12,"th"),l.ud(13,"User Email"),l.Dc(),l.Ec(14,"th"),l.ud(15,"Role"),l.Dc(),l.zc(16,"th"),l.Dc(),l.Dc(),l.Dc(),l.Dc(),l.Dc(),l.Ec(17,"div",6),l.sd(18,g,23,2,"div",7),l.sd(19,h,23,2,"div",7),l.Dc(),l.Dc()),2&t&&(l.mc(7),l.Vc("dtOptions",e.dtOptions)("dtTrigger",e.dtTrigger),l.mc(11),l.Vc("ngIf",!e.isEditableRoute),l.mc(1),l.Vc("ngIf",e.isEditableRoute))},directives:[o.a,i.k,a.t,a.o,a.i,p.b,p.a,a.c,p.d,a.n,a.g,m.a,b.b],styles:[""]}),t}(),E=[{path:"",component:v},{path:":id",component:v}],y=function(){function t(){}return t.\u0275mod=l.wc({type:t}),t.\u0275inj=l.vc({factory:function(e){return new(e||t)},imports:[[s.g.forChild(E)],s.g]}),t}(),D=r("Awto");r.d(e,"UsersModule",(function(){return w}));var w=function(){function t(){}return t.\u0275mod=l.wc({type:t}),t.\u0275inj=l.vc({factory:function(e){return new(e||t)},imports:[[i.c,D.a,y]]}),t}()}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{TUd1:function(t,i,e){"use strict";e.r(i);var o=e("ofXK"),c=e("tyNb"),n=e("3Pt+"),r=e("njyG"),s=e("K9Ia"),a=e("AytR"),d=e("tk/3"),u=e("fXoL"),l=function(){function t(t){this.http=t,this.token=JSON.parse(localStorage.getItem("tokenAdmin"))}return t.prototype.getCitiesDT=function(){return a.a.baseUrl+"CityController/getCitiesDT?auth_token="+this.token.auth_token+"&session_id="+this.token.session_id},t.prototype.getDistricts=function(){return this.http.get(a.a.baseUrl+"CityController/getDistricts?auth_token="+this.token.auth_token+"&session_id="+this.token.session_id)},t.prototype.getSelectedCity=function(t){var i=new d.g({fromObject:t});return this.http.post(a.a.baseUrl+"CityController/getSelectedCity?auth_token="+this.token.auth_token+"&session_id="+this.token.session_id,i)},t.prototype.addCity=function(t){var i=new d.g({fromObject:t});return this.http.post(a.a.baseUrl+"CityController/addCity?auth_token="+this.token.auth_token+"&session_id="+this.token.session_id,i)},t.prototype.editCity=function(t){var i=new d.g({fromObject:t});return this.http.post(a.a.baseUrl+"CityController/editCity?auth_token="+this.token.auth_token+"&session_id="+this.token.session_id,i)},t.prototype.deleteCity=function(t){var i=new d.g({fromObject:t});return this.http.post(a.a.baseUrl+"CityController/deleteCity?auth_token="+this.token.auth_token+"&session_id="+this.token.session_id,i)},t.\u0275fac=function(i){return new(i||t)(u.Hc(d.c))},t.\u0275prov=u.uc({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),p=e("EVdn"),f=e("qT8p"),h=e("bTqV"),y=e("CYa2"),m=e("lwXW");function C(t,i){if(1&t){var e=u.Ec();u.Dc(0,"div",7),u.Dc(1,"h3",1),u.pd(2,"Add Cities"),u.Cc(),u.Dc(3,"form",12),u.Kc("ngSubmit",(function(){return u.ed(e),u.Oc().onSubmit()})),u.Dc(4,"div",5),u.Dc(5,"div",13),u.Dc(6,"div",14),u.Dc(7,"label",15),u.pd(8,"District"),u.Cc(),u.zc(9,"ng-select2",16),u.Cc(),u.Dc(10,"div",14),u.Dc(11,"label",17),u.pd(12,"City Name"),u.Cc(),u.zc(13,"input",18),u.Cc(),u.Cc(),u.Dc(14,"div",13),u.Dc(15,"button",19),u.pd(16,"Add City"),u.Cc(),u.Dc(17,"button",20),u.Kc("click",(function(){return u.ed(e),u.Oc().clearForm()})),u.pd(18,"Clear"),u.Cc(),u.Cc(),u.Cc(),u.Cc(),u.Cc()}if(2&t){var o=u.Oc();u.mc(3),u.Tc("formGroup",o.formGroup),u.mc(6),u.Tc("data",o.districtsData)}}function b(t,i){if(1&t){var e=u.Ec();u.Dc(0,"div",7),u.Dc(1,"h3",1),u.pd(2,"Edit Cities"),u.Cc(),u.Dc(3,"form",12),u.Kc("ngSubmit",(function(){return u.ed(e),u.Oc().onUpdate()})),u.Dc(4,"div",5),u.Dc(5,"div",13),u.Dc(6,"div",14),u.Dc(7,"label",15),u.pd(8,"District"),u.Cc(),u.zc(9,"ng-select2",16),u.Cc(),u.Dc(10,"div",14),u.Dc(11,"label",17),u.pd(12,"City Name"),u.Cc(),u.zc(13,"input",18),u.Cc(),u.Cc(),u.Dc(14,"div",13),u.Dc(15,"button",19),u.pd(16,"Edit City"),u.Cc(),u.Dc(17,"button",21),u.pd(18,"Clear"),u.Cc(),u.Cc(),u.Cc(),u.Cc(),u.Cc()}if(2&t){var o=u.Oc();u.mc(3),u.Tc("formGroup",o.formGroup),u.mc(6),u.Tc("data",o.districtsData)}}var g=function(){function t(t,i,e,o){this.cities=t,this.toastr=i,this.route=e,this.router=o,this.dtOptions={},this.dtTrigger=new s.a,this.isEditableRoute=!1,this.param={},this.cityData=[]}return t.prototype.ngOnInit=function(){var t=this;this.getDistricts(),this.formGroup=new n.h({district_id:new n.f("",[n.s.required]),city:new n.f("",[n.s.required,n.s.minLength(2),n.s.maxLength(100)])}),this.route.paramMap.subscribe((function(i){t.param=i,void 0!==t.param.params.id&&(t.isEditableRoute=!0,t.getSelectedCity())})),this.dtOptions={pagingType:"full_numbers",pageLength:10,serverSide:!0,processing:!0,autoWidth:!1,ajax:this.cities.getCitiesDT(),columns:[{data:"city_id"},{data:"district_name"},{data:"city"}],columnDefs:[{targets:3,data:function(t){return'<a class="edit-city-data" data-id="'+t.city_id+'" title="Edit"><i class="icon-pencil"></i></a> <a class="delete-city-data" data-id="'+t.city_id+'" title="Edit"><i class="icon-bin"></i></a>'}}],dom:"lfrtip",buttons:[{extend:"copyHtml5",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"excelHtml5",text:'<i class="fa fa-file-excel-o"></i> Excel',titleAttr:"Export to Excel"},{extend:"csvHtml5",text:'<i class="fa fa-file-text-o"></i> CSV',titleAttr:"Export to CSV"},{extend:"pdfHtml5",text:'<i class="fa fa-file-pdf-o"></i> PDF',titleAttr:"Export to PDF"}]};var i=this;p("html").on("click","a.delete-city-data",(function(t){t.preventDefault(),i.openDeleteCityModal(p(this).attr("data-id"))}));var e=this;p("html").on("click","a.edit-city-data",(function(t){t.preventDefault(),e.editCityPage(p(this).attr("data-id"))}))},t.prototype.ngAfterViewInit=function(){this.dtTrigger.next()},t.prototype.ngOnDestroy=function(){this.dtTrigger.unsubscribe()},t.prototype.rerender=function(){var t=this;this.dtElement.dtInstance.then((function(i){i.destroy(),t.dtTrigger.next()}))},t.prototype.editCityPage=function(t){this.router.navigate(["admin/cities/"+t])},t.prototype.onSubmit=function(){var t=this;this.formGroup.invalid||this.cities.addCity(this.formGroup.value).subscribe((function(i){200==i.status?(t.toastr.success("New city has been added successfully","Success !"),t.formGroup.reset(),p("#refresh-btn").trigger("click")):t.toastr.error("New city adding failed. Please try again","Error !")}))},t.prototype.onUpdate=function(){var t=this;this.formGroup.invalid||(this.formGroup.value.city_id=this.param.params.id,this.cities.editCity(this.formGroup.value).subscribe((function(i){200==i.status?(t.toastr.success("City has been edited successfully","Success !"),t.formGroup.reset(),p("#refresh-btn").trigger("click"),t.returnBack()):t.toastr.error(401==i.status?"Invalid user token or session has been expired. Please re-loging and try again.":"City editing failed. Please try again","Error !")})))},t.prototype.returnBack=function(){this.router.navigate(["admin/cities"])},t.prototype.getSelectedCity=function(){var t=this;this.cities.getSelectedCity({city_id:this.param.params.id}).subscribe((function(i){200==i.status?(t.cityData=i.data[0],t.formGroup.setValue({district_id:t.cityData.district_id,city:t.cityData.city})):console.log(i)}))},t.prototype.openDeleteCityModal=function(t){var i=this,e=bootbox.confirm({title:"Delete City",message:"Are you sure you need to delete this?",buttons:{confirm:{label:"Yes",className:"btn-danger pull-left"},cancel:{label:"No",className:"pull-right "}},callback:function(e){e&&i.deleteCity(t)}});e.init((function(){p("html .modal-backdrop:not(:first)").remove()})),e.on("shown.bs.modal",(function(){p("html .bootbox.modal:not(:first)").remove()}))},t.prototype.deleteCity=function(t){var i=this;this.formGroup.value.city_id=t,this.cities.deleteCity(this.formGroup.value).subscribe((function(t){200==t.status?(i.toastr.success("City has been deleted successfully","Success !"),p("#refresh-btn").trigger("click")):i.toastr.error("City deleting failed. Please try again","Error !")}))},t.prototype.clearForm=function(){this.formGroup.reset()},t.prototype.getDistricts=function(){var t=this;this.cities.getDistricts().subscribe((function(i){var e=[];200==i.status?i.data.forEach((function(i,o){e.push({id:i.district_id,text:i.district_name}),t.districtsData=e})):console.log(i)}))},t.\u0275fac=function(i){return new(i||t)(u.yc(l),u.yc(f.b),u.yc(c.a),u.yc(c.c))},t.\u0275cmp=u.sc({type:t,selectors:[["app-cities"]],viewQuery:function(t,i){var e;1&t&&u.ud(r.a,!0),2&t&&u.ad(e=u.Lc())&&(i.dtElement=e.first)},decls:27,vars:4,consts:[[1,"right-container","animated","fadeIn"],[1,"title"],["mat-button","",1,"transparent-btn","back-btn"],[1,"icon-left-arrow"],[1,"clearfix"],[1,"row"],[1,"col-md-7"],[1,"white-box-panel"],["id","refresh-btn","type","button",1,"btn","waves-effect","waves-light","blue","d-none",3,"click"],["datatable","",1,"row-border","hover",3,"dtOptions","dtTrigger"],[1,"col-md-5"],["class","white-box-panel",4,"ngIf"],["id","myform","novalidate","novalidate",1,"wrapped-block",3,"formGroup","ngSubmit"],[1,"col-md-12"],[1,"form-group"],["for","district_id"],["formControlName","district_id",1,"select-fw",3,"data"],["for","city"],["id","city","name","city","formControlName","city","type","text",1,"form-control"],["mat-button","","name","submit","type","submit",1,"btn","btn-primary"],["mat-button","","type","button",1,"btn","btn-default","clear-btn",3,"click"],["mat-button","","type","button",1,"btn","btn-default","clear-btn"]],template:function(t,i){1&t&&(u.Dc(0,"div",0),u.Dc(1,"div",1),u.Dc(2,"h2"),u.Dc(3,"button",2),u.zc(4,"i",3),u.Cc(),u.pd(5," Cities"),u.Cc(),u.zc(6,"div",4),u.Cc(),u.Dc(7,"div",5),u.Dc(8,"div",6),u.Dc(9,"div",7),u.Dc(10,"h3",1),u.pd(11,"Cities List"),u.Cc(),u.Dc(12,"button",8),u.Kc("click",(function(){return i.rerender()})),u.pd(13," Rerender "),u.Cc(),u.Dc(14,"table",9),u.Dc(15,"thead"),u.Dc(16,"tr"),u.Dc(17,"th"),u.pd(18,"City Id"),u.Cc(),u.Dc(19,"th"),u.pd(20,"District"),u.Cc(),u.Dc(21,"th"),u.pd(22,"City Name"),u.Cc(),u.zc(23,"th"),u.Cc(),u.Cc(),u.Cc(),u.Cc(),u.Cc(),u.Dc(24,"div",10),u.nd(25,C,19,2,"div",11),u.nd(26,b,19,2,"div",11),u.Cc(),u.Cc(),u.Cc()),2&t&&(u.mc(14),u.Tc("dtOptions",i.dtOptions)("dtTrigger",i.dtTrigger),u.mc(11),u.Tc("ngIf",!i.isEditableRoute),u.mc(1),u.Tc("ngIf",i.isEditableRoute))},directives:[h.b,r.a,o.k,n.t,n.o,n.i,y.b,y.a,m.a,n.n,n.g,n.c,y.d],styles:[""]}),t}(),v=[{path:"",component:g},{path:":id",component:g},{path:":id/:prov_id",component:g}],D=function(){function t(){}return t.\u0275mod=u.wc({type:t}),t.\u0275inj=u.vc({factory:function(i){return new(i||t)},imports:[[c.g.forChild(v)],c.g]}),t}(),k=e("Awto");e.d(i,"CitiesModule",(function(){return _}));var _=function(){function t(){}return t.\u0275mod=u.wc({type:t}),t.\u0275inj=u.vc({factory:function(i){return new(i||t)},imports:[[o.c,D,k.a]]}),t}()}}]);